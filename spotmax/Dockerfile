FROM registry.git.embl.org/grp-cbbcs/abcdesktop-apps/base-image:ubuntu22-cuda-11-8
USER root

ENV LANG=C.UTF-8 LC_ALL=C.UTF-8
ENV QT_XCB_NO_MITSHM=1
ENV NVIDIA_DRIVER_CAPABILITIES "compute,utility"
ENV CONDA_BIN_PATH="/opt/conda/bin"
ENV PATH $CONDA_BIN_PATH:$PATH

RUN DEBIAN_FRONTEND=noninteractive apt-get update -y && apt-get install -y bzip2 wget ca-certificates curl firefox \
    && echo 'debconf debconf/frontend select Noninteractive' | debconf-set-selections

RUN DEBIAN_FRONTEND=noninteractive apt-get install -y build-essential \
	libglu1-mesa-dev \
	libgl1-mesa-glx \
	nautilus \
        xdg-utils \
        wget \
        konsole \
        libblas-dev \
        liblapack-dev \
        libgl1 \
        mesa-utils \
        libxcb-cursor0 \
        libxcb-xinerama0 \
        libatlas-base-dev \
        gfortran \
        apt-utils \
        bzip2 \
        git \
        ca-certificates \
        curl \
        locales \
        libarchive-dev \
        cmake \
        libxcb-cursor-dev \
        unzip &&  apt-get clean && \
        rm -rf /var/lib/apt/lists/* && \
        sed -i '/en_US.UTF-8/s/^# //g' /etc/locale.gen && \
        locale-gen

RUN wget https://github.com/conda-forge/miniforge/releases/latest/download/Miniforge3-Linux-x86_64.sh \
    && bash Miniforge3-Linux-x86_64.sh -b -p /opt/conda \
    && rm -f Miniforge3-Linux-x86_64.sh 

RUN  conda create --name acdc --yes python=3.10 -c conda-forge \
     && /opt/conda/envs/acdc/bin/pip install --upgrade pip \
     && /opt/conda/envs/acdc/bin/pip install torch==2.5.1 torchvision==0.20.1 torchaudio==2.5.1 --index-url https://download.pytorch.org/whl/cu118 \
     && /opt/conda/envs/acdc/bin/pip install git+https://github.com/SchmollerLab/Cell_ACDC.git \

     && /opt/conda/envs/acdc/bin/pip install "spotmax" \
     && /opt/conda/envs/acdc/bin/pip install PyQt6==6.6.0 PyQt6-Qt6==6.6.0 qtpy pyqtgraph seaborn tables 


LABEL oc.icon="spotmax.svg"
LABEL oc.icondata="PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjxzdmcKICAgd2lkdGg9IjMybW0iCiAgIGhlaWdodD0iMzJtbSIKICAgdmlld0JveD0iMCAwIDMyLjAwMDAwMSAzMi4wMDAwMDEiCiAgIHZlcnNpb249IjEuMSIKICAgaWQ9InN2ZzgiCiAgIGlua3NjYXBlOnZlcnNpb249IjEuMyAoMGUxNTBlZDZjNCwgMjAyMy0wNy0yMSkiCiAgIHNvZGlwb2RpOmRvY25hbWU9InNwb3RNQVhfbG9nby5zdmciCiAgIGlua3NjYXBlOmV4cG9ydC1maWxlbmFtZT0iRzpcTXkgRHJpdmVcMDFfUG9zdGRvY19ITUdVXFB5dGhvbl9NeVNjcmlwdHNcTUlBXEdpdFxzcG90TUFYX3YyXHNwb3RtYXhccmVzb3VyY2VzXGxvZ28ucG5nIgogICBpbmtzY2FwZTpleHBvcnQteGRwaT0iMzAwIgogICBpbmtzY2FwZTpleHBvcnQteWRwaT0iMzAwIgogICB4bWxuczppbmtzY2FwZT0iaHR0cDovL3d3dy5pbmtzY2FwZS5vcmcvbmFtZXNwYWNlcy9pbmtzY2FwZSIKICAgeG1sbnM6c29kaXBvZGk9Imh0dHA6Ly9zb2RpcG9kaS5zb3VyY2Vmb3JnZS5uZXQvRFREL3NvZGlwb2RpLTAuZHRkIgogICB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIKICAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiCiAgIHhtbG5zOmNjPSJodHRwOi8vY3JlYXRpdmVjb21tb25zLm9yZy9ucyMiCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyI+CiAgPGRlZnMKICAgICBpZD0iZGVmczIiPgogICAgPGxpbmVhckdyYWRpZW50CiAgICAgICBpbmtzY2FwZTpjb2xsZWN0PSJhbHdheXMiCiAgICAgICBpZD0ibGluZWFyR3JhZGllbnQxMTIyIj4KICAgICAgPHN0b3AKICAgICAgICAgc3R5bGU9InN0b3AtY29sb3I6IzlmOTVkNTtzdG9wLW9wYWNpdHk6MC45MzE3MjY5MyIKICAgICAgICAgb2Zmc2V0PSIwIgogICAgICAgICBpZD0ic3RvcDExMTgiIC8+CiAgICAgIDxzdG9wCiAgICAgICAgIHN0eWxlPSJzdG9wLWNvbG9yOiMxYjAwNTQ7c3RvcC1vcGFjaXR5OjEiCiAgICAgICAgIG9mZnNldD0iMSIKICAgICAgICAgaWQ9InN0b3AxMTIwIiAvPgogICAgPC9saW5lYXJHcmFkaWVudD4KICAgIDxsaW5lYXJHcmFkaWVudAogICAgICAgaW5rc2NhcGU6Y29sbGVjdD0iYWx3YXlzIgogICAgICAgaWQ9ImxpbmVhckdyYWRpZW50MTA4NyI+CiAgICAgIDxzdG9wCiAgICAgICAgIHN0eWxlPSJzdG9wLWNvbG9yOiNmZmYwMDA7c3RvcC1vcGFjaXR5OjEiCiAgICAgICAgIG9mZnNldD0iMCIKICAgICAgICAgaWQ9InN0b3AxMDc5IiAvPgogICAgICA8c3RvcAogICAgICAgICBzdHlsZT0ic3RvcC1jb2xvcjojZTBkYTAwO3N0b3Atb3BhY2l0eTowLjgwNzg0MzE1IgogICAgICAgICBvZmZzZXQ9IjAuMjc0Njc3MTkiCiAgICAgICAgIGlkPSJzdG9wMTA4MSIgLz4KICAgICAgPHN0b3AKICAgICAgICAgc3R5bGU9InN0b3AtY29sb3I6IzAxYmMwMDtzdG9wLW9wYWNpdHk6MC42MDI0MDk2NiIKICAgICAgICAgb2Zmc2V0PSIwLjU3NDM1ODA1IgogICAgICAgICBpZD0ic3RvcDEwODMiIC8+CiAgICAgIDxzdG9wCiAgICAgICAgIHN0eWxlPSJzdG9wLWNvbG9yOiM2NzU5YjM7c3RvcC1vcGFjaXR5OjA7IgogICAgICAgICBvZmZzZXQ9IjEiCiAgICAgICAgIGlkPSJzdG9wMTA4NSIgLz4KICAgIDwvbGluZWFyR3JhZGllbnQ+CiAgICA8bGluZWFyR3JhZGllbnQKICAgICAgIGlua3NjYXBlOmNvbGxlY3Q9ImFsd2F5cyIKICAgICAgIGlkPSJsaW5lYXJHcmFkaWVudDEwMDciPgogICAgICA8c3RvcAogICAgICAgICBzdHlsZT0ic3RvcC1jb2xvcjojZmZmMDAwO3N0b3Atb3BhY2l0eToxIgogICAgICAgICBvZmZzZXQ9IjAiCiAgICAgICAgIGlkPSJzdG9wMTAwMyIgLz4KICAgICAgPHN0b3AKICAgICAgICAgc3R5bGU9InN0b3AtY29sb3I6I2UwZGEwMDtzdG9wLW9wYWNpdHk6MC44MDc4NDMxNSIKICAgICAgICAgb2Zmc2V0PSIwLjIyNDA2NjgyIgogICAgICAgICBpZD0ic3RvcDEwMTEiIC8+CiAgICAgIDxzdG9wCiAgICAgICAgIHN0eWxlPSJzdG9wLWNvbG9yOiMwMWJjMDA7c3RvcC1vcGFjaXR5OjAuMzc2NDcwNiIKICAgICAgICAgb2Zmc2V0PSIwLjU3NDM1ODA1IgogICAgICAgICBpZD0ic3RvcDEwMDkiIC8+CiAgICAgIDxzdG9wCiAgICAgICAgIHN0eWxlPSJzdG9wLWNvbG9yOiM2NzU5YjM7c3RvcC1vcGFjaXR5OjA7IgogICAgICAgICBvZmZzZXQ9IjEiCiAgICAgICAgIGlkPSJzdG9wMTAwNSIgLz4KICAgIDwvbGluZWFyR3JhZGllbnQ+CiAgICA8aW5rc2NhcGU6cGF0aC1lZmZlY3QKICAgICAgIGVmZmVjdD0ic3Bpcm8iCiAgICAgICBpZD0icGF0aC1lZmZlY3Q5OTciCiAgICAgICBpc192aXNpYmxlPSJ0cnVlIgogICAgICAgbHBldmVyc2lvbj0iMSIgLz4KICAgIDxpbmtzY2FwZTpwYXRoLWVmZmVjdAogICAgICAgZWZmZWN0PSJzcGlybyIKICAgICAgIGlkPSJwYXRoLWVmZmVjdDk5MyIKICAgICAgIGlzX3Zpc2libGU9InRydWUiCiAgICAgICBscGV2ZXJzaW9uPSIxIiAvPgogICAgPGlua3NjYXBlOnBhdGgtZWZmZWN0CiAgICAgICBlZmZlY3Q9InNwaXJvIgogICAgICAgaWQ9InBhdGgtZWZmZWN0OTg5IgogICAgICAgaXNfdmlzaWJsZT0idHJ1ZSIKICAgICAgIGxwZXZlcnNpb249IjEiIC8+CiAgICA8aW5rc2NhcGU6cGF0aC1lZmZlY3QKICAgICAgIGVmZmVjdD0ic3Bpcm8iCiAgICAgICBpZD0icGF0aC1lZmZlY3Q4MzUiCiAgICAgICBpc192aXNpYmxlPSJ0cnVlIgogICAgICAgbHBldmVyc2lvbj0iMSIgLz4KICAgIDxyYWRpYWxHcmFkaWVudAogICAgICAgaW5rc2NhcGU6Y29sbGVjdD0iYWx3YXlzIgogICAgICAgeGxpbms6aHJlZj0iI2xpbmVhckdyYWRpZW50MTEyMiIKICAgICAgIGlkPSJyYWRpYWxHcmFkaWVudDg1MSIKICAgICAgIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIgogICAgICAgZ3JhZGllbnRUcmFuc2Zvcm09Im1hdHJpeCgxLjU3MjIyNzcsLTAuMDA0NDQzNDUsMC4wMzAyOTc1MiwxLjI1NjQ5ODYsLTIzLjE4OTM3Niw1LjAzOTU1NzgpIgogICAgICAgY3g9IjE0Ljc4NTg5MSIKICAgICAgIGN5PSIxNC4wNTkxMSIKICAgICAgIGZ4PSIxNC43ODU4OTEiCiAgICAgICBmeT0iMTQuMDU5MTEiCiAgICAgICByPSIxMi43MTYzMzIiIC8+CiAgICA8cmFkaWFsR3JhZGllbnQKICAgICAgIGlua3NjYXBlOmNvbGxlY3Q9ImFsd2F5cyIKICAgICAgIHhsaW5rOmhyZWY9IiNsaW5lYXJHcmFkaWVudDEwMDciCiAgICAgICBpZD0icmFkaWFsR3JhZGllbnQ4NjEtNSIKICAgICAgIGN4PSI4LjU4ODI0MTYiCiAgICAgICBjeT0iMTYuMTU0ODUyIgogICAgICAgZng9IjguNTg4MjQxNiIKICAgICAgIGZ5PSIxNi4xNTQ4NTIiCiAgICAgICByPSIyLjIyMTY3NzgiCiAgICAgICBncmFkaWVudFRyYW5zZm9ybT0ibWF0cml4KDIuMDk0ODc5NCwyLjM0MTc5MiwtMi4xNDk0NzA1LDIuMTY1NDI3NiwzMC4wNDE5MDEsLTQzLjAwMzc5NSkiCiAgICAgICBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgLz4KICAgIDxyYWRpYWxHcmFkaWVudAogICAgICAgaW5rc2NhcGU6Y29sbGVjdD0iYWx3YXlzIgogICAgICAgeGxpbms6aHJlZj0iI2xpbmVhckdyYWRpZW50MTA4NyIKICAgICAgIGlkPSJyYWRpYWxHcmFkaWVudDg2MS01LTIiCiAgICAgICBjeD0iOC41ODgyNDE2IgogICAgICAgY3k9IjE2LjE1NDg1MiIKICAgICAgIGZ4PSI4LjU4ODI0MTYiCiAgICAgICBmeT0iMTYuMTU0ODUyIgogICAgICAgcj0iMi4yMjE2Nzc4IgogICAgICAgZ3JhZGllbnRUcmFuc2Zvcm09Im1hdHJpeCgyLjA5NDg3OTQsMi4zNDE3OTIsLTIuMTQ5NDcwNSwyLjE2NTQyNzYsMzAuNTcwOTkyLC0zMS45NDk0ODkpIgogICAgICAgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIC8+CiAgICA8cmFkaWFsR3JhZGllbnQKICAgICAgIGlua3NjYXBlOmNvbGxlY3Q9ImFsd2F5cyIKICAgICAgIHhsaW5rOmhyZWY9IiNsaW5lYXJHcmFkaWVudDEwMDciCiAgICAgICBpZD0icmFkaWFsR3JhZGllbnQ4NjEtNS0yLTkiCiAgICAgICBjeD0iOC41ODgyNDE2IgogICAgICAgY3k9IjE2LjE1NDg1MiIKICAgICAgIGZ4PSI4LjU4ODI0MTYiCiAgICAgICBmeT0iMTYuMTU0ODUyIgogICAgICAgcj0iMi4yMjE2Nzc4IgogICAgICAgZ3JhZGllbnRUcmFuc2Zvcm09Im1hdHJpeCgyLjA5NDg3OTQsMi4zNDE3OTIsLTIuMTQ5NDcwNSwyLjE2NTQyNzYsMzkuOTYxMzgyLC00MC43NzQzMTgpIgogICAgICAgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIC8+CiAgICA8cmFkaWFsR3JhZGllbnQKICAgICAgIGlua3NjYXBlOmNvbGxlY3Q9ImFsd2F5cyIKICAgICAgIHhsaW5rOmhyZWY9IiNsaW5lYXJHcmFkaWVudDEwODciCiAgICAgICBpZD0icmFkaWFsR3JhZGllbnQ4NjEtNS0yLTkwIgogICAgICAgY3g9IjguNTg4MjQxNiIKICAgICAgIGN5PSIxNi4xNTQ4NTIiCiAgICAgICBmeD0iOC41ODgyNDE2IgogICAgICAgZnk9IjE2LjE1NDg1MiIKICAgICAgIHI9IjIuMjIxNjc3OCIKICAgICAgIGdyYWRpZW50VHJhbnNmb3JtPSJtYXRyaXgoMi4wOTQ4Nzk0LDIuMzQxNzkyLC0yLjE0OTQ3MDUsMi4xNjU0Mjc2LDM5LjY2NDI3LC00MC42NjIwNTgpIgogICAgICAgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIC8+CiAgPC9kZWZzPgogIDxzb2RpcG9kaTpuYW1lZHZpZXcKICAgICBpZD0iYmFzZSIKICAgICBwYWdlY29sb3I9IiNmZmZmZmYiCiAgICAgYm9yZGVyY29sb3I9IiM2NjY2NjYiCiAgICAgYm9yZGVyb3BhY2l0eT0iMS4wIgogICAgIGlua3NjYXBlOnBhZ2VvcGFjaXR5PSIwLjAiCiAgICAgaW5rc2NhcGU6cGFnZXNoYWRvdz0iMiIKICAgICBpbmtzY2FwZTp6b29tPSIzLjk1OTc5OCIKICAgICBpbmtzY2FwZTpjeD0iMTA1LjgxMzQ4IgogICAgIGlua3NjYXBlOmN5PSI2Ni4wMzg3MjMiCiAgICAgaW5rc2NhcGU6ZG9jdW1lbnQtdW5pdHM9Im1tIgogICAgIGlua3NjYXBlOmN1cnJlbnQtbGF5ZXI9ImxheWVyMSIKICAgICBpbmtzY2FwZTpkb2N1bWVudC1yb3RhdGlvbj0iMCIKICAgICBzaG93Z3JpZD0iZmFsc2UiCiAgICAgaW5rc2NhcGU6d2luZG93LXdpZHRoPSIxOTIwIgogICAgIGlua3NjYXBlOndpbmRvdy1oZWlnaHQ9IjExMjkiCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjE5MTIiCiAgICAgaW5rc2NhcGU6d2luZG93LXk9Ii04IgogICAgIGlua3NjYXBlOndpbmRvdy1tYXhpbWl6ZWQ9IjEiCiAgICAgaW5rc2NhcGU6cGFnZWNoZWNrZXJib2FyZD0iMCIKICAgICBpbmtzY2FwZTpzaG93cGFnZXNoYWRvdz0iMiIKICAgICBpbmtzY2FwZTpkZXNrY29sb3I9IiNkMWQxZDEiPgogICAgPGlua3NjYXBlOmdyaWQKICAgICAgIHR5cGU9Inh5Z3JpZCIKICAgICAgIGlkPSJncmlkODQxIgogICAgICAgb3JpZ2lueD0iMCIKICAgICAgIG9yaWdpbnk9IjAiCiAgICAgICBzcGFjaW5neT0iMSIKICAgICAgIHNwYWNpbmd4PSIxIgogICAgICAgdW5pdHM9Im1tIgogICAgICAgdmlzaWJsZT0iZmFsc2UiIC8+CiAgPC9zb2RpcG9kaTpuYW1lZHZpZXc+CiAgPG1ldGFkYXRhCiAgICAgaWQ9Im1ldGFkYXRhNSI+CiAgICA8cmRmOlJERj4KICAgICAgPGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPgogICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PgogICAgICAgIDxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4KICAgICAgPC9jYzpXb3JrPgogICAgPC9yZGY6UkRGPgogIDwvbWV0YWRhdGE+CiAgPGcKICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIgogICAgIGlkPSJsYXllcjEiPgogICAgPGcKICAgICAgIGlkPSJnMSI+CiAgICAgIDxlbGxpcHNlCiAgICAgICAgIHN0eWxlPSJmaWxsOnVybCgjcmFkaWFsR3JhZGllbnQ4NjEtNS0yLTkpO2ZpbGwtb3BhY2l0eToxO2ZpbGwtcnVsZTpldmVub2RkO3N0cm9rZTpub25lO3N0cm9rZS13aWR0aDowLjUxMDY5MTtzdHJva2UtbGluZWNhcDpyb3VuZDtzdHJva2UtbGluZWpvaW46cm91bmQ7c3Ryb2tlLW1pdGVybGltaXQ6NDtzdHJva2UtZGFzaGFycmF5Om5vbmUiCiAgICAgICAgIGlkPSJwYXRoODUzLTMtNi05IgogICAgICAgICBjeD0iMjMuMTYxMTA4IgogICAgICAgICBjeT0iMTMuOTYyOTk2IgogICAgICAgICByeD0iNy44OTcyMDg3IgogICAgICAgICByeT0iNy43NzE1MzMiIC8+CiAgICAgIDxlbGxpcHNlCiAgICAgICAgIHN0eWxlPSJmaWxsOnVybCgjcmFkaWFsR3JhZGllbnQ4NTEpO2ZpbGwtb3BhY2l0eToxO2ZpbGwtcnVsZTpldmVub2RkO3N0cm9rZTojNGU0ZTRlO3N0cm9rZS13aWR0aDowLjExNDQ2MTtzdHJva2UtbGluZWNhcDpyb3VuZDtzdHJva2UtbGluZWpvaW46cm91bmQ7c3Ryb2tlLW1pdGVybGltaXQ6NDtzdHJva2UtZGFzaGFycmF5Om5vbmU7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgICAgaWQ9InBhdGg4MzciCiAgICAgICAgIGN4PSIwLjQ4MzM2MjkxIgogICAgICAgICBjeT0iMjIuNjM5MTExIgogICAgICAgICByeD0iMTQuMTMzMjU1IgogICAgICAgICByeT0iMTIuMTE3Mjk5IgogICAgICAgICB0cmFuc2Zvcm09Im1hdHJpeCgwLjY5MTE5NjUsLTAuNzIyNjY2ODcsMC42OTExOTY1LDAuNzIyNjY2ODcsMCwwKSIgLz4KICAgICAgPGVsbGlwc2UKICAgICAgICAgc3R5bGU9ImZpbGw6dXJsKCNyYWRpYWxHcmFkaWVudDg2MS01KTtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MC41MTA2OTE7c3Ryb2tlLWxpbmVjYXA6cm91bmQ7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS1taXRlcmxpbWl0OjQ7c3Ryb2tlLWRhc2hhcnJheTpub25lIgogICAgICAgICBpZD0icGF0aDg1My0zIgogICAgICAgICBjeD0iMTMuMjQxNjI3IgogICAgICAgICBjeT0iMTEuNzMzNTE3IgogICAgICAgICByeD0iNy44OTcyMDg3IgogICAgICAgICByeT0iNy43NzE1MzMiIC8+CiAgICAgIDxlbGxpcHNlCiAgICAgICAgIHN0eWxlPSJmaWxsOiNmZjAwMDA7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjAuMTA1MTkzO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2UtbWl0ZXJsaW1pdDo0O3N0cm9rZS1kYXNoYXJyYXk6bm9uZTtzdHJva2Utb3BhY2l0eToxIgogICAgICAgICBpZD0icGF0aDk0NyIKICAgICAgICAgY3g9IjEzLjMwODQ0NCIKICAgICAgICAgY3k9IjEyLjAzNDE5NSIKICAgICAgICAgcng9IjAuNjk2OTM1NTkiCiAgICAgICAgIHJ5PSIwLjcxNjc5MTMzIiAvPgogICAgICA8ZWxsaXBzZQogICAgICAgICBzdHlsZT0iZmlsbDp1cmwoI3JhZGlhbEdyYWRpZW50ODYxLTUtMik7ZmlsbC1vcGFjaXR5OjE7ZmlsbC1ydWxlOmV2ZW5vZGQ7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjAuNTEwNjkxO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2UtbWl0ZXJsaW1pdDo0O3N0cm9rZS1kYXNoYXJyYXk6bm9uZSIKICAgICAgICAgaWQ9InBhdGg4NTMtMy02IgogICAgICAgICBjeD0iMTMuNzcwNzE4IgogICAgICAgICBjeT0iMjIuNzg3ODI1IgogICAgICAgICByeD0iNy44OTcyMDg3IgogICAgICAgICByeT0iNy43NzE1MzMiIC8+CiAgICAgIDxlbGxpcHNlCiAgICAgICAgIHN0eWxlPSJmaWxsOnVybCgjcmFkaWFsR3JhZGllbnQ4NjEtNS0yLTkwKTtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MC41MTA2OTE7c3Ryb2tlLWxpbmVjYXA6cm91bmQ7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS1taXRlcmxpbWl0OjQ7c3Ryb2tlLWRhc2hhcnJheTpub25lIgogICAgICAgICBpZD0icGF0aDg1My0zLTYtNyIKICAgICAgICAgY3g9IjIyLjg2Mzk5NyIKICAgICAgICAgY3k9IjE0LjA3NTI1NCIKICAgICAgICAgcng9IjcuODk3MjA4NyIKICAgICAgICAgcnk9IjcuNzcxNTMzIiAvPgogICAgICA8ZWxsaXBzZQogICAgICAgICBzdHlsZT0iZmlsbDojZmYwMDAwO2ZpbGwtb3BhY2l0eToxO2ZpbGwtcnVsZTpldmVub2RkO3N0cm9rZTpub25lO3N0cm9rZS13aWR0aDowLjEwNTE5MztzdHJva2UtbGluZWNhcDpyb3VuZDtzdHJva2UtbGluZWpvaW46cm91bmQ7c3Ryb2tlLW1pdGVybGltaXQ6NDtzdHJva2UtZGFzaGFycmF5Om5vbmU7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgICAgaWQ9InBhdGg5NDctMCIKICAgICAgICAgY3g9IjEzLjgzNzUzNSIKICAgICAgICAgY3k9IjIzLjA4ODUwMyIKICAgICAgICAgcng9IjAuNjk2OTM1NTkiCiAgICAgICAgIHJ5PSIwLjcxNjc5MTMzIiAvPgogICAgICA8cGF0aAogICAgICAgICBzb2RpcG9kaTp0eXBlPSJzdGFyIgogICAgICAgICBzdHlsZT0ib3BhY2l0eToxO2ZpbGw6I2ZmZmZmZjtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MC4xNTQ2MDg7c3Ryb2tlLWxpbmVjYXA6cm91bmQ7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS1taXRlcmxpbWl0OjQ7c3Ryb2tlLWRhc2hhcnJheTpub25lO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICAgIGlkPSJwYXRoMTAwMSIKICAgICAgICAgc29kaXBvZGk6c2lkZXM9IjMiCiAgICAgICAgIHNvZGlwb2RpOmN4PSIyNy45OTM4NiIKICAgICAgICAgc29kaXBvZGk6Y3k9IjE4LjgwNDMxNiIKICAgICAgICAgc29kaXBvZGk6cjE9IjMuMzk1NTQ2IgogICAgICAgICBzb2RpcG9kaTpyMj0iMS42OTc3NzMiCiAgICAgICAgIHNvZGlwb2RpOmFyZzE9IjEuMDQ3MTk3NiIKICAgICAgICAgc29kaXBvZGk6YXJnMj0iMi4wOTQzOTUxIgogICAgICAgICBpbmtzY2FwZTpmbGF0c2lkZWQ9InRydWUiCiAgICAgICAgIGlua3NjYXBlOnJvdW5kZWQ9IjAiCiAgICAgICAgIGlua3NjYXBlOnJhbmRvbWl6ZWQ9IjAiCiAgICAgICAgIHRyYW5zZm9ybT0ibWF0cml4KDAuNzE4ODA4NzYsLTEuMDE2NTM0OCwwLjU2MDYxNTM5LDAuMzg4NzExNTgsLTEzLjY2NDMzNSwyNy42Nzk2MjkpIgogICAgICAgICBpbmtzY2FwZTp0cmFuc2Zvcm0tY2VudGVyLXg9Ii0wLjMzMjkyOTUzIgogICAgICAgICBpbmtzY2FwZTp0cmFuc2Zvcm0tY2VudGVyLXk9Ii0wLjI0NDYwNzk1IgogICAgICAgICBkPSJtIDI5LjY5MTYzMywyMS43NDQ5NDUgLTUuMDkzMzE5LC0yLjk0MDYzIDUuMDkzMzE5LC0yLjk0MDYyOCB6IiAvPgogICAgICA8ZWxsaXBzZQogICAgICAgICBzdHlsZT0iZmlsbDojZmYwMDAwO2ZpbGwtb3BhY2l0eToxO2ZpbGwtcnVsZTpldmVub2RkO3N0cm9rZTpub25lO3N0cm9rZS13aWR0aDowLjEwNTE5MztzdHJva2UtbGluZWNhcDpyb3VuZDtzdHJva2UtbGluZWpvaW46cm91bmQ7c3Ryb2tlLW1pdGVybGltaXQ6NDtzdHJva2UtZGFzaGFycmF5Om5vbmU7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgICAgaWQ9InBhdGg5NDctMyIKICAgICAgICAgY3g9IjIyLjkxMTI0MyIKICAgICAgICAgY3k9IjE0LjM5MTgwOSIKICAgICAgICAgcng9IjAuNjk2OTM1NTkiCiAgICAgICAgIHJ5PSIwLjcxNjc5MTMzIiAvPgogICAgPC9nPgogIDwvZz4KPC9zdmc+Cg=="
LABEL oc.keyword="SpotMAX"
LABEL oc.cat="development"
LABEL oc.template="abcdesktopio/oc.template.ubuntu.22.04"
LABEL oc.name="spotmax"
LABEL oc.desktopfile="org.kde.konsole.desktop"
LABEL oc.launch="spotmax.SpotMAX"
LABEL oc.displayname="SpotMAX"
LABEL oc.path="/opt/conda/envs/acdc/bin/spotmax"
LABEL oc.type=app
LABEL oc.rules="{\"homedir\":{\"default\":true}}"
LABEL oc.showinview=dock
LABEL oc.acl="{\"permit\":[\"all\"]}"

RUN  if [ -d /usr/share/icons ];   then cd /usr/share/icons;    /composer/safelinks.sh; fi \
     &&  if [ -d /usr/share/pixmaps ]; then cd /usr/share/pixmaps;  /composer/safelinks.sh; fi 

ENV APPNAME "spotmax"
ENV APPBIN "/opt/conda/envs/acdc/bin/spotmax"
ENV APP "/opt/conda/envs/acdc/bin/spotmax"

RUN mkdir -p /run/user \
    && chmod 777 /run/user

USER root
RUN mkdir -p /etc/localaccount \
    && for f in passwd shadow group gshadow ; do if [ -f /etc/$f ] ; then  cp /etc/$f /etc/localaccount; rm -f /etc/$f; ln -s /etc/localaccount/$f /etc/$f; fi; done

CMD ["sh", "-c","mkdir -p ~/tmp && /composer/appli-docker-entrypoint.sh " ]


