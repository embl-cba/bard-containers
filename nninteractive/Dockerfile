FROM registry.git.embl.org/grp-cbbcs/abcdesktop-apps/base-image:ubuntu22-cuda-12-3

ARG DEBIAN_FRONTEND="noninteractive"

ENV LANG en_US.UTF-8 \
    LC_ALL en_US.UTF-8 \
    LANGUAGE en_US:en  \
    NUMBA_CACHE_DIR=/tmp


RUN apt-get update -y && \
    apt-get install -y -q --no-install-recommends \
            gcc \
            wget \
            qtcreator \
            python3-dev \
            python3-pip \
            python3-wheel \
            libblas-dev \
            liblapack-dev \
            libgl1 \
            mesa-utils \
            libxcb-cursor0 \
            libgl1-mesa-glx \
            libxcb-xinerama0 \
            libatlas-base-dev \
            gfortran \
            apt-utils \
            bzip2 \
            ca-certificates \
            curl \
            konsole \
            locales \
            libarchive-dev \
            cmake \
            libxcb-cursor0 \
            libxcb-cursor-dev \
            unzip &&  apt-get clean && \
            rm -rf /var/lib/apt/lists/* && \
            sed -i '/en_US.UTF-8/s/^# //g' /etc/locale.gen && \
            locale-gen


WORKDIR /tmp
RUN wget https://github.com/conda-forge/miniforge/releases/latest/download/Miniforge3-Linux-x86_64.sh \
    && bash Miniforge3-Linux-x86_64.sh -b -p /opt/conda \
    && rm -f Miniforge3-Linux-x86_64.sh 

LABEL oc.icon="nninteractive.svg"
LABEL oc.icondata="PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/Pgo8IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDIwMDEwOTA0Ly9FTiIKICJodHRwOi8vd3d3LnczLm9yZy9UUi8yMDAxL1JFQy1TVkctMjAwMTA5MDQvRFREL3N2ZzEwLmR0ZCI+CjxzdmcgdmVyc2lvbj0iMS4wIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiB3aWR0aD0iMjM0MS4wMDAwMDBwdCIgaGVpZ2h0PSI2MDUuMDAwMDAwcHQiIHZpZXdCb3g9IjAgMCAyMzQxLjAwMDAwMCA2MDUuMDAwMDAwIgogcHJlc2VydmVBc3BlY3RSYXRpbz0ieE1pZFlNaWQgbWVldCI+Cgo8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwLjAwMDAwMCw2MDUuMDAwMDAwKSBzY2FsZSgwLjEwMDAwMCwtMC4xMDAwMDApIgpmaWxsPSIjMDAwMDAwIiBzdHJva2U9Im5vbmUiPgo8cGF0aCBkPSJNMTc1IDUzNzggYy0zIC0xMyAtNCAtNDM3IC0zIC05NDMgbDMgLTkyMCA5NDAgMCA5NDAgMCAwIDk0MCAwIDk0MAotOTM3IDMgLTkzOCAyIC01IC0yMnogbTE4MjUgLTkyMyBsMCAtODg1IC04ODUgMCAtODg1IDAgMCA4ODUgMCA4ODUgODg1IDAKODg1IDAgMCAtODg1eiIvPgo8cGF0aCBkPSJNMTAxMiA1MTczIGMtMTA2IC01MiAtMTA0IC0yMDEgNCAtMjUzIDU5IC0yOSAxMTMgLTIxIDE1OSAyNSAxMTUKMTE1IC0xNyAzMDAgLTE2MyAyMjh6IG05MiAtOTkgYzIyIC0yMSAyMCAtNDAgLTYgLTU4IC0zOSAtMjggLTg0IDIwIC01MiA1NQoyMSAyMyAzOCAyNCA1OCAzeiIvPgo8cGF0aCBkPSJNNDk1IDQ4MzAgYy0xMTggLTc3IC02NCAtMjYwIDc2IC0yNjAgMTA5IDAgMTc1IDExMSAxMjUgMjA4IC0zNSA2OAotMTM3IDk0IC0yMDEgNTJ6IG05OSAtODYgYzEwIC00IDE2IC0xOCAxNiAtMzUgMCAtMjIgLTYgLTMwIC0yNSAtMzUgLTQzIC0xMQotNzMgMzQgLTQzIDY0IDEzIDEzIDI4IDE1IDUyIDZ6Ii8+CjxwYXRoIGQ9Ik0xNjQyIDQ2NjMgYy0xMDYgLTUyIC0xMDQgLTIwMSA0IC0yNTMgNTkgLTI5IDExMyAtMjEgMTU5IDI1IDExNQoxMTUgLTE3IDMwMCAtMTYzIDIyOHogbTkyIC05OSBjMjIgLTIxIDIwIC00MCAtNiAtNTggLTM5IC0yOCAtODQgMjAgLTUyIDU1CjIxIDIzIDM4IDI0IDU4IDN6Ii8+CjxwYXRoIGQ9Ik0xMDk3IDQ1MjUgYy00OCAtMTcgLTY3IC0zMyAtODQgLTcyIC0xOSAtNDYgLTE2IC05MyA3IC0xMzEgNzggLTEyNwoyNjUgLTc0IDI2MiA3NiAtMSA5NSAtOTQgMTU5IC0xODUgMTI3eiBtNzggLTEyOSBjMCAtMzYgLTI3IC01NiAtNTIgLTQwIC00MAoyNSAtMjAgNzcgMjYgNzIgMjEgLTIgMjYgLTggMjYgLTMyeiIvPgo8cGF0aCBkPSJNNTAyIDQxOTAgYy0xMjcgLTc4IC03NCAtMjY1IDc2IC0yNjIgMTA2IDEgMTcwIDExOSAxMTYgMjEzIC0zNyA2NQotMTI4IDg4IC0xOTIgNDl6IG05OCAtOTQgYzYgLTggMTAgLTI1IDggLTM4IC02IC00MiAtNzggLTMyIC03OCAxMSAwIDM3IDQ2CjU1IDcwIDI3eiIvPgo8cGF0aCBkPSJNMTM4MCAzOTQwIGMtNjkgLTM2IC05NyAtMTM5IC01NCAtMTk3IDY5IC05MiAxODEgLTk0IDI0MSAtNCA0NiA2OQoxOSAxNjUgLTU3IDIwMyAtNDQgMjMgLTg2IDIyIC0xMzAgLTJ6IG05NSAtOTMgYzIxIC0xNiAxNSAtNjEgLTExIC03MSAtMzkKLTE1IC03MyA0MSAtNDIgNzIgMTYgMTYgMzAgMTUgNTMgLTF6Ii8+CjxwYXRoIGQ9Ik0yMTk1IDUzNzggYy0zIC0xMyAtNCAtNDM3IC0zIC05NDMgbDMgLTkyMCA5NDAgMCA5NDAgMCAwIDk0MCAwIDk0MAotOTM3IDMgLTkzOCAyIC01IC0yMnogbTE4MjUgLTkyMyBsMCAtODg1IC04ODUgMCAtODg1IDAgMCA4ODUgMCA4ODUgODg1IDAKODg1IDAgMCAtODg1eiIvPgo8cGF0aCBkPSJNMjQ0OSA1MTg2IGMtMzcgLTI1IC02OSAtODUgLTY5IC0xMjggMCAtMzcgMzggLTEwMiA3MCAtMTIxIGwzMCAtMTgKMiAtNDUwIGMxIC0yNDcgMiAtNDU1IDIgLTQ2MyAxIC04IC0xNCAtMjUgLTMzIC0zOCAtNzEgLTQ5IC04OSAtMTQwIC00MCAtMjA5CjU4IC04MiAxOTcgLTc4IDI1MCA3IGwyMSAzNCA0NTYgMCA0NTcgMCAxNyAtMzAgYzY5IC0xMjEgMjYyIC03OSAyNzYgNjEgNiA2MwotMTUgMTEwIC02NSAxNDAgbC0zMyAyMSAwIDQ2MSAwIDQ2MiAzMCAxNyBjNjYgMzggOTEgMTM4IDUwIDIwNiAtNTggOTUgLTIwNAo5NiAtMjU4IDIgbC0xNyAtMzAgLTQ1NyAwIC00NTYgMCAtMjEgMzQgYy00MiA2NyAtMTQ1IDg3IC0yMTIgNDJ6IG0xMTkgLTg4CmMxOSAtMTkgMTUgLTY2IC03IC03OCAtMzEgLTE2IC00OSAtMTIgLTY3IDE1IC0xNSAyMyAtMTUgMjcgMCA1MCAxOCAyNyA1NCAzMwo3NCAxM3ogbTEyMTEgLTIgYzM4IC00NiAtMjUgLTExMSAtNjkgLTcxIC0yNCAyMiAtMjUgNDIgLTMgNjcgMTkgMjIgNTYgMjQgNzIKNHogbS0xNjQgLTExNSBjOCAtMTcgMjggLTM4IDQ1IC00OCBsMzAgLTE3IDAgLTQ2NyAwIC00NjYgLTI0IC0xMSBjLTE0IC02Ci0zNSAtMjUgLTQ3IC00MSBsLTIzIC0zMSAtNDYwIDAgLTQ2MSAwIC0xNyAzMCBjLTkgMTcgLTI4IDM1IC00MiA0MSBsLTI1IDEyCi0zIDQ2MSAtMyA0NjEgNTAgNTEgNTAgNTIgNDU3IDEgNDU3IDEgMTYgLTI5eiBtLTEwNDcgLTExMDMgYzcgLTcgMTIgLTIxIDEyCi0zMyAwIC00NSAtNTMgLTYxIC04NSAtMjUgLTE1IDE3IC0xNiAyNCAtNyA0NSAxMyAyNyA1OCAzNSA4MCAxM3ogbTEyMTIgLTIKYzE1IC0xOSA5IC01NiAtMTEgLTY5IC05IC01IC0yOCAtNyAtNDIgLTMgLTUyIDEzIC00MiA4NiAxMiA4NiAxNiAwIDM0IC03IDQxCi0xNHoiLz4KPHBhdGggZD0iTTQyODAgNDUxMCBsMCAtODkwIDIyMCAwIDIyMCAwIDAgNjY1IDAgNjY1IDY2NSAwIDY2NSAwIDAgMjI1IDAgMjI1Ci04ODUgMCAtODg1IDAgMCAtODkweiIvPgo8cGF0aCBkPSJNMTg0NTUgNDM5MSBjLTY4IC0xNyAtMTAwIC01OCAtMTExIC0xNDMgLTggLTYwIDEyIC0xNTAgMzkgLTE3NiA1MAotNDcgMjI5IC01NiAyOTggLTE2IDUwIDI5IDY0IDY1IDY0IDE2NiAwIDk2IC0xNSAxMzAgLTcxIDE1NyAtMzMgMTcgLTE3MyAyNAotMjE5IDEyeiIvPgo8cGF0aCBkPSJNOTIxNSA0MzE0IGMtNTEgLTggLTgzIC0yNSAtODkgLTQ3IC04IC0yOSAtOCAtMTcwNSAwIC0xNzM0IDEwIC0zNQo1OCAtNDggMTg0IC00OCAxMjYgMCAxNzQgMTMgMTg0IDQ4IDcgMjggOCAxNzA1IDAgMTczMyAtMyAxMiAtMTggMjcgLTMyIDM0Ci0yOCAxMiAtMTk0IDIyIC0yNDcgMTR6Ii8+CjxwYXRoIGQ9Ik0xMTUwMCA0MTcwIGMtNTUgLTEzIC02MCAtMjggLTYwIC0xODcgbDAgLTE0MyAtODYgMCAtODUgMCAtMTYgLTM3CmMtMTEgLTI4IC0xNCAtNjEgLTExIC0xMjUgNiAtMTE4IDE1IC0xMjggMTIwIC0xMjggbDc4IDAgMCAtMzM0IGMwIC00NDkgMTUKLTU0MiAxMDEgLTYzOSA1MyAtNjEgMTIzIC05MyAyMzIgLTEwOCAxMzAgLTE2IDI4OCA5IDMyNCA1MyAzMyA0MCAzOSAyMTMgOAoyNTQgLTEyIDE3IC0xNSAxNyAtNjUgMSAtMTA4IC0zNSAtMTg4IC0xNSAtMjIwIDU1IC0xOCA0MCAtMjAgNjggLTIwIDM4MSBsMAozMzcgMTM4IDAgYzk1IDAgMTQzIDQgMTU1IDEzIDM4IDI3IDQ1IDIwMSAxMSAyNTUgLTE0IDIxIC0yMCAyMiAtMTU5IDIyCmwtMTQ1IDAgMCAxNDMgYzAgMTYyIC00IDE3MyAtNjUgMTg3IC00OCAxMSAtMTg3IDExIC0yMzUgMHoiLz4KPHBhdGggZD0iTTE3NDkwIDQxNzAgYy01NSAtMTQgLTYwIC0yOCAtNjAgLTE4NyBsMCAtMTQzIC04NCAwIGMtMTEwIDAgLTExMQotMiAtMTExIC0xNDAgMCAtMTQyIDYgLTE1MCAxMTcgLTE1MCBsNzggMCAwIC0zNDIgYzAgLTE4OSA1IC0zNzMgMTAgLTQxMCAzMAotMjA4IDEyNyAtMzA1IDMzMCAtMzI5IDc5IC05IDExMCAtOSAxODMgNCA5NyAxNyAxMzMgMzUgMTQ3IDczIDE2IDQwIDEyIDIwNwotNCAyMjkgLTEzIDE5IC0xNiAxOSAtNjggMiAtMTA1IC0zMyAtMTgxIC0xNyAtMjE1IDQ2IC0xNiAyOCAtMTggNzAgLTIxIDM4MApsLTMgMzQ3IDEzOCAwIGM3NiAwIDE0MyA0IDE0OSA4IDI1IDE2IDM0IDU1IDM0IDE0NCAwIDE0MCAzIDEzOCAtMTc2IDEzOApsLTE0NCAwIDAgMTM0IGMwIDE0MiAtNyAxNzggLTM3IDE5MSAtMjcgMTEgLTIyMyAxNSAtMjYzIDV6Ii8+CjxwYXRoIGQ9Ik02NjQzIDM4NTUgYy05NiAtMjcgLTE5NiAtODggLTI4NSAtMTczIGwtMzggLTM2IDAgNzkgYzAgNDQgLTQgODYKLTggOTIgLTEzIDIwIC0xMjAgMzYgLTE5MCAyOCAtMTEyIC0xMiAtMTAyIDUyIC0xMDIgLTY3OCAwIC00OTEgMyAtNjM3IDEzCi02NTAgMjYgLTM2IDI0NSAtNDYgMzE0IC0xNCBsMjMgMTAgMCA0MzIgMCA0MzIgNzMgNzAgYzEwNSAxMDIgMTcyIDEzMSAyNTcKMTEyIDg4IC0yMCAxMzggLTgxIDE1OSAtMTk0IDcgLTM2IDExIC0yMTIgMTEgLTQ1NiBsMCAtMzk3IDMzIC0xMyBjNDUgLTE5CjI0MiAtMTggMjgyIDIgbDMwIDE0IDMgNDAwIGMzIDQyNiAtNSA1NzUgLTM4IDY3MSAtNDMgMTIzIC0xMjYgMjEyIC0yMzcgMjU0Ci03NiAyOSAtMjI2IDM2IC0zMDAgMTV6Ii8+CjxwYXRoIGQ9Ik04MTgxIDM4NTQgYy03OCAtMjEgLTE2MSAtNjggLTI0NiAtMTQxIGwtNzUgLTY0IDAgODUgYzAgNzEgLTMgODcKLTE3IDk0IC0zMCAxNSAtMTIxIDIzIC0xODUgMTYgLTEwNyAtMTIgLTk4IDUwIC05OCAtNjc3IDAgLTQ5NSAzIC02MzcgMTMKLTY1MSAyNSAtMzQgMjM3IC00NCAzMTUgLTE1IGwyMiA5IDAgNDMxIDAgNDMxIDYzIDY1IGMxMDIgMTA2IDE3OSAxNDEgMjcwCjEyMSA2MiAtMTMgMTA4IC01MyAxMzggLTEyMCAyNCAtNTMgMjQgLTU1IDI3IC00ODYgbDMgLTQzMiAyNiAtMTcgYzM1IC0yMwoyNDMgLTI1IDI4OCAtMiBsMzAgMTQgMCA0NzAgYzAgMzM2IC00IDQ4NyAtMTMgNTMwIC0xNyA4MiAtNjIgMTc1IC0xMTIgMjI5Ci05NyAxMDUgLTI5MSAxNTMgLTQ0OSAxMTB6Ii8+CjxwYXRoIGQ9Ik0xMDQ4MiAzODU0IGMtOTAgLTI0IC0xNzQgLTc1IC0yNTkgLTE1OCBsLTUzIC01MCAwIDc5IGMwIDQ0IC00IDg2Ci04IDkzIC0yNyA0MiAtMjU3IDQyIC0yODMgMCAtNSAtNyAtOSAtMzAyIC05IC02NTUgbDAgLTY0MyAyNyAtMTcgYzIyIC0xNSA0OQotMTggMTQ4IC0xOCA2OSAxIDEzMiA2IDE0OCAxMyBsMjcgMTIgMCA0MzEgMCA0MzEgNjYgNjkgYzExMyAxMTYgMjE0IDE0NyAzMTQKOTcgMzYgLTE5IDUxIC0zNSA3NSAtODIgbDMwIC02MCA1IC00MzkgYzUgLTQxMiA2IC00MzkgMjMgLTQ1MiA0MyAtMzEgMjY2Ci0zMSAzMTQgMSBsMjMgMTQgMCA0MTEgYzAgNDI5IC04IDU2MiAtNDEgNjU2IC02NCAxODggLTIwOCAyODQgLTQyMiAyODIgLTQwCjAgLTk2IC03IC0xMjUgLTE1eiIvPgo8cGF0aCBkPSJNMTI3NTAgMzg1NCBjLTEwOSAtMjMgLTIxOCAtODMgLTI5MSAtMTYyIC0xMDcgLTExMyAtMTU5IC0yMzggLTE4MQotNDMwIC0xMyAtMTIzIC0yIC0yODYgMjkgLTM5MiA0MyAtMTUxIDEzOSAtMjczIDI2NSAtMzM0IDEyMCAtNTkgMTgxIC03MSAzNjgKLTcxIDE3NCAwIDI0OSAxMCAzODIgNTIgMTEwIDM0IDExOSA0OSAxMTYgMTc2IC00IDEzMSAtNCAxMzEgLTE0MCA4OSAtMTQ1Ci00NSAtMjA3IC01NSAtMzMzIC01MCAtODggMyAtMTIxIDkgLTE2MyAyNyAtOTUgNDIgLTE0OSAxMjcgLTE2NyAyNjIgbC02IDQ2CjQwNyA4IGMyNzIgNSA0MTMgMTEgNDI1IDE4IDM1IDIyIDQyIDYxIDM3IDIwNSAtNiAxNDkgLTI3IDIzMiAtODQgMzI5IC02NQoxMTIgLTE5MiAxOTggLTMzNSAyMjggLTg3IDE4IC0yNDIgMTggLTMyOSAtMXogbTI4MiAtMjU5IGM2NyAtMzMgMTE2IC0xMjIKMTI1IC0yMjcgbDYgLTY4IC0yNjQgMiAtMjY0IDMgNCA0NSBjOCAxMTAgODcgMjI5IDE3MSAyNTcgNTAgMTcgMTc3IDEwIDIyMgotMTJ6Ii8+CjxwYXRoIGQ9Ik0xNDMxMyAzODQ2IGMtNTEgLTI0IC0xMzUgLTk4IC0xODYgLTE2NiBsLTI3IC0zNSAwIDY3IGMwIDkxIC0xMAoxMTQgLTU3IDEyNyAtODUgMjQgLTIyMyA4IC0yNDMgLTI5IC02IC0xMiAtMTAgLTI0MyAtMTAgLTY0OSAwIC03MjkgLTEwIC02NjQKMTA1IC02NzYgODYgLTEwIDIwMiAxIDIzMiAyMSBsMjMgMTQgMCA0MDQgMCA0MDQgNDMgNTkgYzI0IDMyIDYzIDc1IDg3IDk2IDcxCjYxIDEyMSA2OCAyMzMgMzYgNDUgLTEzIDUwIC0xMiA2MiA1IDI5IDM5IDM0IDI3NyA3IDMwOSAtMzUgNDIgLTE5MSA0OSAtMjY5CjEzeiIvPgo8cGF0aCBkPSJNMTUxMTAgMzg2MSBjLTE2MCAtMzAgLTMwNSAtOTAgLTM0NCAtMTQ0IC0xNyAtMjQgLTIxIC00MiAtMjAgLTEwNwoyIC0xMzUgMzQgLTE1NiAxNDcgLTk5IDExMyA1OCAxOTQgODEgMzAyIDg2IDEyMSA2IDE3NyAtNyAyMjEgLTUxIDM5IC0zOSA1NAotODkgNTQgLTE4MyBsMCAtNzMgLTEzMiAwIGMtMjExIDAgLTM3OCAtMzMgLTQ4MiAtOTQgLTEzNiAtODAgLTIwMiAtMjI5IC0xNzcKLTM5OCAzMyAtMjEyIDE5NyAtMzM3IDQ0NiAtMzM4IDEzMyAwIDIzOCAzNiAzNDMgMTE5IGw1MSA0MSA2IC00OCBjMTEgLTgyIDIxCi04OSAxNDAgLTkxIDkzIC0xIDE0MyAxMyAxNTEgNDMgMyAxMiA0IDI0MyAyIDUxMiAtNCA0NjIgLTUgNDkyIC0yNCA1NTAgLTQ0CjEyOSAtMTIzIDIwNiAtMjU5IDI1MCAtNjkgMjMgLTEwMSAyNyAtMjMwIDMwIC04MiAxIC0xNzAgLTEgLTE5NSAtNXogbTM2MAotOTAwIGwwIC0xMDggLTQ5IC00NiBjLTYzIC01OSAtMTIyIC04OCAtMTkxIC05NCAtMTYzIC0xNSAtMjU3IDExMCAtMTg3IDI0NwozOSA3OCAxMjMgMTA3IDMxNSAxMDkgbDExMiAxIDAgLTEwOXoiLz4KPHBhdGggZD0iTTE2NTY1IDM4NTQgYy0yMzAgLTQ1IC0zOTQgLTIyMyAtNDUwIC00ODkgLTIzIC0xMDggLTI0IC0zMzEgLTEKLTQ0MCAzOCAtMTgyIDE0NCAtMzMzIDI4MCAtNDAwIDk2IC00OCAyMTMgLTY5IDMzNiAtNjIgMTQ2IDggMjkyIDYxIDM1NSAxMjcKMjkgMzEgMzAgMzMgMzAgMTM4IDAgMTE3IC03IDE1NyAtMjkgMTY1IC04IDMgLTUxIC0xOCAtOTYgLTQ4IC0xMDcgLTcxIC0xNTkKLTg4IC0yNjQgLTg0IC03MCAzIC04OSA4IC0xMjMgMzEgLTk2IDYzIC0xMzMgMTUyIC0xNDAgMzM4IC02IDE0NyA1IDIyMSA0NwozMDcgNTAgMTAxIDEyMCAxNDMgMjM2IDE0MyA4MCAwIDE0MSAtMjEgMjI4IC03NyAxMTQgLTc0IDEzOCAtNTIgMTM0IDEyMSBsLTMKMTA4IC0zNSAzMCBjLTExMCA5MiAtMzE3IDEzMCAtNTA1IDkyeiIvPgo8cGF0aCBkPSJNMjA4MTEgMzg1NCBjLTI2OCAtNTggLTQ0MyAtMjgwIC00NzAgLTU5OCAtMTAgLTExNiAwIC0yNzYgMjMgLTM2OAo1MiAtMjA3IDE5MiAtMzQ4IDQwMSAtNDA0IDkwIC0yNCAzMDkgLTI5IDQzMCAtMTEgMTIzIDE5IDI1OSA2MSAyODQgODggMjggMzEKNDEgMTYwIDIxIDIxNCAtNSAxNCAtMTcgMjggLTI2IDMyIC05IDMgLTYwIC04IC0xMTMgLTI1IC0xMzEgLTQzIC0yMTMgLTU1Ci0zMzkgLTUwIC04MyAzIC0xMTkgOSAtMTU4IDI3IC05NSA0MiAtMTUyIDEyOSAtMTYyIDI0NiBsLTUgNjIgNDA0IDggYzI2NyA1CjQwOSAxMSA0MjAgMTggMzQgMjEgNDQgNjcgNDIgMTgyIC02IDMxNyAtMTU2IDUyNSAtNDE4IDU4MCAtODcgMTggLTI0OSAxOAotMzM0IC0xeiBtMjg5IC0yNjUgYzczIC00MCAxMjAgLTEzNSAxMjAgLTI0MSBsMCAtNDggLTI2MSAwIC0yNjIgMCA2IDU4IGMxMAoxMTAgNjYgMTk4IDE1MiAyMzkgNjcgMzIgMTc5IDI5IDI0NSAtOHoiLz4KPHBhdGggZD0iTTE4NDM2IDM4MzkgYy0yMiAtNSAtNDUgLTE0IC01MyAtMjAgLTExIC05IC0xMyAtMTMyIC0xMyAtNjU1IGwwCi02NDQgMjcgLTE3IGMyMiAtMTUgNDkgLTE4IDE1MyAtMTggODMgMCAxMzIgNCAxNDggMTMgbDIyIDEzIDAgNjUzIDAgNjUzIC0yNwoxMyBjLTM1IDE2IC0yMDUgMjIgLTI1NyA5eiIvPgo8cGF0aCBkPSJNMTg5ODQgMzg0MSBjLTQ3IC0xMiAtNTQgLTE5IC01NCAtNTkgMCAtNDUgMzk2IC0xMjQwIDQxOSAtMTI2NSAyMgotMjMgMTExIC0zNyAyMzcgLTM3IDEyMCAwIDIwMyAxNCAyMjUgMzggMjAgMjAgNDA2IDExNzcgNDE1IDEyNDMgOCA1OSAtOCA3NQotODIgODUgLTcxIDggLTIwNCAwIC0yMzIgLTE1IC0yNCAtMTMgLTMxIC0zNCAtMjExIC02MjYgLTgwIC0yNjIgLTExMSAtMzU1Ci0xMTcgLTM0MCAtNSAxMSAtNzIgMjI2IC0xNTAgNDc5IC03OCAyNTIgLTE0OSA0NjUgLTE1NyA0NzMgLTggOCAtMzIgMTkgLTUzCjIzIC00NiAxMSAtMTk2IDExIC0yNDAgMXoiLz4KPHBhdGggZD0iTTE3NSAzMzk4IGMtMyAtMTMgLTQgLTQzOSAtMyAtOTQ4IGwzIC05MjUgOTQwIDAgOTQwIDAgMCA5NDUgMCA5NDUKLTkzNyAzIC05MzggMiAtNSAtMjJ6IG0xODI1IC05MjggbDAgLTg5MCAtODg1IDAgLTg4NSAwIDAgODkwIDAgODkwIDg4NSAwCjg4NSAwIDAgLTg5MHoiLz4KPHBhdGggZD0iTTY1MyAzMTc5IGMtNjMgLTMxIC05NyAtMTEwIC03NCAtMTcxIDcgLTE5IDAgLTM1IC00NSAtOTggLTUzIC03MwotNTUgLTc0IC05MyAtNzEgLTEzOSAxMCAtMjEwIC0xNTcgLTEwNiAtMjQ4IDQwIC0zNCA5MiAtNDggMTMzIC0zMyAyNiA5IDQxIDIKMTg1IC05MiAxMzggLTkwIDE1NSAtMTA0IDE1MCAtMTI0IC0xNSAtNjMgNDEgLTE1MiAxMDYgLTE2NyAyNiAtNSAzMiAtMTMgNDEKLTQ4IDYgLTIzIDE1IC01NiAyMCAtNzMgNyAtMjggNCAtMzQgLTIyIC01NCAtNjAgLTQ0IC03NCAtMTM2IC0yOSAtMTk5IDMxCi00MyAxMDAgLTY3IDE1MCAtNTIgMjIgNiA1MCAyMyA2MyAzNyAxMiAxNCAzMCAzMyAzOCA0MyAxMSAxMSA4MSAyNyAyNDggNTQKbDIzMiAzOCAzMyAtMzQgYzE4IC0xOSA1MSAtNDAgNzMgLTQ3IDM2IC0xMSA0NyAtMTAgODcgOCA1OCAyNiA4NyA3MCA4NyAxMzIKMCA1MiAtMjYgMTAxIC02NyAxMjYgLTE1IDEwIC0yOSAxOCAtMzAgMTggLTEgMSAtMTggNzkgLTM4IDE3NSBsLTM2IDE3NCAzOAozOSBjMzYgMzcgMzggNDIgMzggMTAzIDAgNjEgLTIgNjcgLTM3IDEwMSAtMjkgMzAgLTQ1IDM4IC04NiA0MiAtMjcgMiAtNTkgLTEKLTcwIC03IC0xOSAtMTAgLTc0IDEyIC00MDEgMTYwIC0zNjMgMTYzIC0zODEgMTczIC0zOTkgMjA4IC0xMiAyMyAtMzQgNDQgLTYyCjU5IC01NSAyNyAtNzQgMjggLTEyNyAxeiBtOTcgLTEwNCBjMTAgLTEyIDEwIC0yMSAyIC00MCAtMTMgLTI5IC00MyAtMzMgLTY2Ci05IC0xOSAxOCAtMTkgMjAgLTYgNDUgMTMgMjMgNTIgMjUgNzAgNHogbTQ4NSAtMjc0IGwzMTAgLTE0MCA2IC01MCBjOCAtNjAKMjggLTk1IDcyIC0xMjEgMzEgLTE5IDMzIC0yNCA2OSAtMTk1IGwzNiAtMTc1IC0zMSAtMzQgYy0xOCAtMTggLTM3IC00MCAtNDMKLTQ4IC04IC0xMCAtOTEgLTI3IC0yNDcgLTUzIGwtMjM2IC0zOCAtMjYgMzEgYy0xNCAxNyAtMzQgMzQgLTQ1IDM3IC0xNCA0Ci0yNCAyOCAtMzkgOTMgbC0yMSA4OCAyNiA0OSBjMjAgMzkgMjQgNTkgMTkgOTAgLTEzIDg1IC05MiAxMzkgLTE3MyAxMTkgLTM2Ci05IC00MiAtNiAtMTg3IDg4IGwtMTUwIDk3IC03IDY3IC03IDY4IDQ4IDY1IGM0NyA2NSA0OCA2NiAxMDIgNzEgNTggNiA4NCAxNwoxMTIgNDggMTggMjAgMTkgMjAgNjAgMiAyMyAtMTEgMTgyIC04MiAzNTIgLTE1OXogbS03ODAgLTc0IGMyMSAtMTYgMTUgLTYxCi0xMSAtNzEgLTM5IC0xNSAtNzMgNDEgLTQyIDcyIDE2IDE2IDMwIDE1IDUzIC0xeiBtMTI3MyAtNzkgYzI3IC0yNyA3IC03OAotMjkgLTc4IC0yMSAwIC00OSAyNiAtNDkgNDUgMCAzNSA1MyA1OCA3OCAzM3ogbS03NTQgLTMwNyBjMzMgLTM2IC0xOCAtODgKLTU1IC01NSAtMjMgMjEgLTI0IDM3IC0zIDU4IDIwIDIxIDM3IDIwIDU4IC0zeiBtODQwIC0zMjQgYzM4IC0yNyAtMiAtOTUgLTQxCi03MSAtMjUgMTYgLTI5IDU1IC03IDcxIDEwIDcgMjEgMTMgMjQgMTMgMyAwIDE0IC02IDI0IC0xM3ogbS03NTAgLTEwMyBjMTkKLTE4IDE5IC0yMCA2IC00NSAtMTMgLTIzIC01MiAtMjUgLTcwIC00IC0xMCAxMiAtMTAgMjEgLTIgNDAgMTMgMjkgNDMgMzMgNjYKOXoiLz4KPHBhdGggZD0iTTIxOTUgMzM4OCBjLTMgLTEzIC00IC00MzcgLTMgLTk0MyBsMyAtOTIwIDk0MCAwIDk0MCAwIDAgOTQwIDAgOTQwCi05MzcgMyAtOTM4IDIgLTUgLTIyeiBtMTgyNSAtOTIzIGwwIC04ODUgLTg4NSAwIC04ODUgMCAwIDg4NSAwIDg4NSA4ODUgMAo4ODUgMCAwIC04ODV6Ii8+CjxwYXRoIGQ9Ik0zMjAyIDMxMTQgYy02MiAtNTcgLTY1IC04NyAtNjYgLTY2NCAtMSAtMzI0IC02IC01MjQgLTEyIC01MzggLTEwCi0yNCAtMTAgLTIzIC00NiAyMCAtMTAwIDEyMiAtMjI3IDM0NyAtNDU4IDgwNyAtOTQgMTg5IC0xNjggMzI0IC0xNzkgMzMxIC01MAoyNiAtMTExIC04IC0xMTEgLTYzIDAgLTI5IDI2MiAtNTU3IDM5NSAtNzk3IDE1NyAtMjgwIDI2NyAtNDMwIDM0NiAtNDcwIDUzCi0yOCAxMDEgLTI2IDEzNyA1IDcwIDU5IDg3IDIxMyA3OCA3MTUgLTMgMTk1IC0zIDM4MCAyIDQxMCBsOCA1NSAzOSAtNzAgYzIxCi0zOCAxMDMgLTIwNyAxODAgLTM3NSAxOTkgLTQyOSAyMzEgLTQ4NyAyODYgLTUxNiA4MyAtNDMgMTQ0IDU1IDgwIDEyOCAtMzMKMzggLTEwNSAxODAgLTIxNiA0MjMgLTIxMCA0NjMgLTMwMyA2MTAgLTM5MSA2MjIgLTM1IDQgLTQ2IDEgLTcyIC0yM3oiLz4KPHBhdGggZD0iTTIyNjMwIDI2MzUgbDAgLTY2NSAtNjY1IDAgLTY2NSAwIDAgLTIyNSAwIC0yMjUgODg1IDAgODg1IDAgMCA4OTAKMCA4OTAgLTIyMCAwIC0yMjAgMCAwIC02NjV6Ii8+CjwvZz4KPC9zdmc+Cg=="
LABEL oc.keyword="nnInteractive"
LABEL oc.cat="development"
LABEL oc.template="abcdesktopio/oc.template.gtk"
LABEL oc.name="nninteractive"
LABEL oc.launch="nninteractive.napari"
LABEL oc.displayname="nnInteractive"
LABEL oc.path="/opt/conda/envs/nnInteractive/bin/napari"
LABEL oc.args="-w napari-nninteractive"
LABEL oc.type=app
LABEL oc.rules="{\"homedir\":{\"default\":true}}"
LABEL oc.acl="{\"permit\":[\"all\"]}"
LABEL oc.showinview=dock

RUN  if [ -d /usr/share/icons ];   then cd /usr/share/icons;    /composer/safelinks.sh; fi 
RUN  if [ -d /usr/share/pixmaps ]; then cd /usr/share/pixmaps;  /composer/safelinks.sh; fi 

ENV APPNAME "nninteractive"
ENV APPBIN "/opt/conda/envs/nnInteractive/bin/napari"
ENV APP "/opt/conda/envs/nnInteractive/bin/napari"
ENV ARGS="-w napari-nninteractive"
ENV CONDA_BIN_PATH="/opt/conda/bin"
ENV PATH $CONDA_BIN_PATH:$PATH
ENV LD_LIBRARY_PATH "/usr/local/nvidia/lib:/usr/local/nvidia/lib64"
ENV NVIDIA_DRIVER_CAPABILITIES "compute,utility"

RUN conda create -y --name nnInteractive python==3.10 libstdcxx-ng=12 -c conda-forge && \
    conda run --name nnInteractive python -m pip install torch==2.5.0 torchvision==0.20.0 torchaudio==2.5.0 --extra-index-url https://download.pytorch.org/whl/cu118 && \
    conda run --name nnInteractive python -m pip install napari[all] napari-nninteractive
RUN mkdir -p /run/user && chmod 777 /run/user

RUN mkdir -p /etc/localaccount && \
    for f in passwd shadow group gshadow ; do if [ -f /etc/$f ] ; then  cp /etc/$f /etc/localaccount; rm -f /etc/$f; ln -s /etc/localaccount/$f /etc/$f; fi; done


CMD ["/composer/appli-docker-entrypoint.sh" ]


