FROM registry.git.embl.org/grp-cbbcs/abcdesktop-apps/base-image:ubuntu22-cuda-11-8

USER root

ARG DEBIAN_FRONTEND=noninteractive
ENV NVIDIA_DRIVER_CAPABILITIES all
ENV VGL_DISPLAY egl0
ENV VGL_COMPRESS proxy

RUN apt-get update -y && \
    apt-get install -y \
            jq \
            unzip \
            wget \
            build-essential \
            git \
            nautilus \
            software-properties-common \
            libxi6 \
            libxrender1 \ 
            libxtst6 \
            libfreetype6 \
            fonts-dejavu \
            fontconfig \
            ca-certificates \ 
            curl \
            libglvnd-dev \
            libgl1-mesa-dev \
            libegl1-mesa-dev \
            libgles2-mesa-dev \
            libglu1-mesa-dev \
            libglvnd0 \
            libgl1 \
            libglx0 \
            libegl1 \
            libgles2 \
            libglu1 \
            mesa-utils \
            libxcb1 \
            libxext6 \
            libxv1 \
            libxtst6 \
            dbus-x11 \
            libxrandr-dev \
            xdg-utils \
            libcanberra-gtk3-dev \ 
            openjdk-17-jdk \ 
            libblosc-dev  && \
    echo 'debconf debconf/frontend select Noninteractive' | debconf-set-selections

RUN wget -O /tmp/firefox-esr.tar.bz2 "https://download.mozilla.org/?product=firefox-esr-latest&os=linux64&lang=en-US" && \
    mkdir -p /opt/firefox && \
    tar -xjf /tmp/firefox-esr.tar.bz2 -C /opt/firefox --strip-components=1 && \
    ln -sf /opt/firefox/firefox /usr/bin/firefox-esr && \
    update-alternatives --install /usr/bin/x-www-browser x-www-browser /usr/bin/firefox-esr 100 && \
    update-alternatives --set x-www-browser /usr/bin/firefox-esr

WORKDIR /opt
RUN git clone --branch v2.0.2 --single-branch https://github.com/glencoesoftware/NGFF-Converter.git

WORKDIR /opt/NGFF-Converter

# patches, remove awt API with xdg-open
COPY PrimaryController.java /opt/NGFF-Converter/src/main/java/com/glencoesoftware/convert/PrimaryController.java
COPY MultiButtonTableCell.java /opt/NGFF-Converter/src/main/java/com/glencoesoftware/convert/tables/MultiButtonTableCell.java
RUN ./gradlew clean build

WORKDIR /opt/NGFF-Converter/build/distributions
RUN unzip *.zip 
  
LABEL oc.icon="ngff.svg"
LABEL oc.icondata="PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgoKPHN2ZwogICB2ZXJzaW9uPSIxLjEiCiAgIGlkPSJzdmcyIgogICB3aWR0aD0iMjYuNTU5OTk5IgogICBoZWlnaHQ9IjMwLjQiCiAgIHZpZXdCb3g9IjAgMCAyNi41NTk5OTkgMzAuNCIKICAgc29kaXBvZGk6ZG9jbmFtZT0ibmdmZi5zdmciCiAgIGlua3NjYXBlOnZlcnNpb249IjEuMi4yIChiMGE4NDg2NTQxLCAyMDIyLTEyLTAxKSIKICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiCiAgIHhtbG5zOnNvZGlwb2RpPSJodHRwOi8vc29kaXBvZGkuc291cmNlZm9yZ2UubmV0L0RURC9zb2RpcG9kaS0wLmR0ZCIKICAgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiCiAgIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIKICAgeG1sbnM6c3ZnPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgPGRlZnMKICAgICBpZD0iZGVmczYiIC8+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlkPSJuYW1lZHZpZXc0IgogICAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIKICAgICBib3JkZXJjb2xvcj0iIzAwMDAwMCIKICAgICBib3JkZXJvcGFjaXR5PSIwLjI1IgogICAgIGlua3NjYXBlOnNob3dwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOnBhZ2VvcGFjaXR5PSIwLjAiCiAgICAgaW5rc2NhcGU6cGFnZWNoZWNrZXJib2FyZD0iMCIKICAgICBpbmtzY2FwZTpkZXNrY29sb3I9IiNkMWQxZDEiCiAgICAgc2hvd2dyaWQ9ImZhbHNlIgogICAgIGlua3NjYXBlOnpvb209IjMzLjc4Mjg5NSIKICAgICBpbmtzY2FwZTpjeD0iMTMuMjkwNzUiCiAgICAgaW5rc2NhcGU6Y3k9IjE1LjIyOTYwMSIKICAgICBpbmtzY2FwZTp3aW5kb3ctd2lkdGg9IjI4ODAiCiAgICAgaW5rc2NhcGU6d2luZG93LWhlaWdodD0iMTQ4MyIKICAgICBpbmtzY2FwZTp3aW5kb3cteD0iMCIKICAgICBpbmtzY2FwZTp3aW5kb3cteT0iMzIiCiAgICAgaW5rc2NhcGU6d2luZG93LW1heGltaXplZD0iMSIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJnOCIgLz4KICA8ZwogICAgIGlua3NjYXBlOmdyb3VwbW9kZT0ibGF5ZXIiCiAgICAgaW5rc2NhcGU6bGFiZWw9IkltYWdlIgogICAgIGlkPSJnOCI+CiAgICA8aW1hZ2UKICAgICAgIHdpZHRoPSIyNS40NTUyNzgiCiAgICAgICBoZWlnaHQ9IjMwLjQiCiAgICAgICBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIgogICAgICAgeGxpbms6aHJlZj0iZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFGTUFBQUJmQ0FZQUFBQ1VjUHQ3QUFBQUFYTlNSMElCMmNrc2Z3QUFBQVJuUVUxQkFBQ3gKand2OFlRVUFBQUFnWTBoU1RRQUFlaVlBQUlDRUFBRDZBQUFBZ09nQUFIVXdBQURxWUFBQU9wZ0FBQmR3bkxwUlBBQUFBQVppUzBkRQpBUDhBL3dEL29MMm5rd0FBQUFsd1NGbHpBQUF1SXdBQUxpTUJlS1UvZGdBQUFBZDBTVTFGQitrSEZ4TVJCYitpbVdvQUFCUEFTVVJCClZIamE3VjNyVDF0NWVuNk9iY0RjN3lRVGhwaHdOd21UWkp5WldiV2RxcXMyaTFiYWxiclZzdEpLSzZwKzZ4OVFxYUw5c0piNklmdDMKMEZXLzBGWmI5UlBLdE5KS3ZXZzM4U1FUTGc3WHhDUUVBdUVPeHNiMk9mM0E4M0plSEVpTTdlUEFUQzFaSkZ6c2M1N2Y4ejd2NWZlKwpQeHNvME1OM2Q4Z0FVQUtnRWtBdGdJOEFkQU80Q2VBVC9yc1dnSXRQZVZqOG1nQ3dER0FLd0JNQWp3SE1BVmdCc0FGZ04zTC8zZ0UrCjRNTmRxRGVxYWYreUNNQWxBRDBBL2dEQVhRQi9CS0FQZ0E5QURZQWlBRWJhbnhwOHVya1lWUUF1QTJnRmNBVkFLUUdQMXJSL0dkdWEKL3kvclE0RnBPTXpHSWdCZUF0QUlvQjNBZFFDM0NXSVR3WENmNFZvc0FFa0Erd0FXQUh6RDV6aUFDSUIxQUxzQTlpUDM3NlVLQ2FiSApRU0JkQUNvQU5CUEFtd0E2QVZ5bGlkY1RhRmNXQkNqaUFsd0ZVRVptM3dUd2xNQk9BM2dGWU9mQ01wTUFGZ01vQjFCSElMc0FCTWpHCnF6VG40ank5djhWbmpMbzVCK0FoTlhXR2dHNENpQUpJUnU3Zk15OEVNK2xnaWdFMDBKbmNBT0NuYWJmUXpDc1VrUGtpZzZHa29vaE8KckJ2QUxJQXdnWjBuMkFmbm1wbSt1ME1lM2t3MUFmT1JoWi95cHNSSkdBN3J0RGdlaythOVNEQi9UejE5QWVBTmZ4WnpRay9kZVdCagpGZGwzQjhDZkFQZysvOTFCQjFPdUdHUTRUQXlER2x6TUJheWgxTFRRWWtySnptaE4rNWVwZkh0K0kwdGRMQ0ZJVmJ6WVBqTHhKb0EyCm1yT2JOK1pveFBBZXBwcjAvT3QwU2s4QWhNallGUUJiMU5PRHlQMTcxb2ZRekdKNjR3NEF2WXdiMndCOHpEaXlKZ3NQN1JSVDNYelcKOHpwcmVhMXpBQ1lKNmh5VGdaVGp6S1FwRnlrMk5xbk01UTR2c281aGpyc0E1cHlMMTAvUzg3OG1TNzltS0RWTDl1NVRUNU5PTWROTgo1OUpDNzl4TGpXd2xHeHNJOUhsK3lBSVg4K25oczVIRW1BRXdRU2xZWkRpVk96UEpSQmZaV0VyV1hTV0lYMUFmcjFBdml6NndMdWFxCnB6SHE1Z0sxTk1UQS95Vy9Id2VReURRK1BZMlpKZFMvYnBweGwySmpFNHNWYmx6Y2graHBPWmxhd2t5cWhSbzZUVTJkQTdCRzBETmoKSnRub1VZV0VSanFZenhrelNwaFRvcGhvNE52eEVKYWFBUGJvakdZWW40YVk3Nzlodm44QUlIV2E1eGRtdXVpRnI1R0ZQUVN3alNZdAplZlMzOGFHOWZvMlN0MXBpTU0zbkZPVmdSeVVJeDEvSWQzZW9sbXhzWmF6NEtldUxMWHhSenhtck9oZjlZVEpNU2dMWVppbzZCdUFCCkk0QWxBdnBXdnU4QjhEMnlzWnRNOUNrSDgxMTh1SlFETGxIYWVwblJqREQxR1lHTmF6RC9rRjY2bXlHUTE4blMzQVdVZ0ZwbWRENlcKRXNmNXZSU0xKM0c5Q24yc016YVRqY1huSklNNVQzcnFUWXUxKy9odnIzTGdSOEZyakRvZ3JMeUlzYVBUM2o1Qmo1NmsrUmNEY0F1UQpBdVpYQUo2VG5lMk1MOHYrSDhOallPNHhrSjlsN0RuRnZINHZQVFQ2TjRZQU4rbTllbkM4a092K0RySlVQSHFNZ0MzaGNEZjBBVDM3ClViRlp4NXdlSWg0bmtNdEV2RU41OXZydm9FTktzQmdTSVhEaXdlZUkxOXBKS2FhSEdyREtYSFNPc2RRTnhwdjdOUDBxNm9UbmdxZVIKbWVoaW5DbGtHTUFqWmtHVEtxMk1ueHEwbjFEb3FHQTFxSTN4cCtUbFBoeldNYitOOFdlS2xhSlg5Qjh6NmprSFlDbHkvMTQ4bTBMSApQbDl3aGF2akkwc0RaS3pPakZ3WE5JeVMrcVprT2x1ODUzSG01SkxwYkpHTmlheEtjR2tzOWNDdVRrdVcxTW4vTi9ObjNnc0s1ajRMCkdBdGszMHg2RG43V1RUZFBodlNmd09IdTNoakJsR3BTR3oyLzl3SlVrM1IxYUplV053dmdkOVRHZWZxT1BWYUh6cnpIbnZHTk16Z3QKWnh3cWxhVXVBdHJLM0xYOEhEc29LVndzMHFSbnljUXdnWHdUdVg5dlA1YzNPR3ZJczArUmx0MCt5VmMvWjZYcEl4d1dqczlMQlY1MApNYzRNVDFmVUoybHQyL3g1TXRjM3kvcG1xYWYxZEVnOXpGazdDUEI1MlJ2YW96bS9aSlZuaGt5Y0J2QXljdi9lUmo3ZkxKZGdYS29tCis3ellKM1JRdCtqNWUrbWdTbEM0WFV0TFpTOXhldVJ4YXVMWGREUWJPS3hGeHZMOTVubTdPZC9kSVM4OXZONVB2NGJDN3FjbktFR3YKbFpjTzQzQ1RiQmJBNjJ5M2NaMW1adnJqZ0hxNnhRc1BzVlFWNE5jMjZxa3J6M3FxMmZpRzcvMkVlZlFVZ1pYT0RVZjdOUjB4Tzk4UApodHl3VUVWbTlsSlB1NVRYcjh0VFpTcEZrTmJvcGVkVlJXZVM4aE4xdXBYd3pNd01qQXpyeGlqTkxBdUFhYmdNczZTbHh2cnZ6MzlzCldYSExOSXFOWFFyK0N1UFVWcFZKZGRMelo5TWRaeWtnZDZpTGs4eGNKbWplcTR3bFkvTDczL3ZQZnpZUzYvc0dMTXVWbHJrSnF5MEEKVm1oZzBDcUVtWmZRZXplcUVwMTR6RlhMdEZaaWtZME5BTkdGMy83S29uNGxBT3o0N2c2dGtUMDcxTFFYTlBzV0hHNGhWekNjeWxRWApOMW5oMHJyNGhQSGplbm9lSFJnWmRpWFdvdEtBSzVaUlNpQzNDTDRNR2lRY01YT3lVWnBJRzJteW56Qkh2OEpmVzJGbTlKZ2h4eEpjClJzeFY0ckVlL09qbkZnRDQvblRJQmRkUlIzRXRRZXlHdlJ2YW9pcFRKMTJYNkdKY2FmSkRIRys1M21Ka2NkU0I4ZG0vLzVOaHhsTXUKV0phMGczZmpzRCtxbTRBbXVBQVQ5UGpUZkowRUFQT3NMRFhlQWFTSE45aEFrMndqbUwzVXYwdjgxVFhxMURpOTVoejFheFhBYm1oZwo4TmhLWC8zeWJ3M0Q2eEpBL1Z5YzlGNzNzalFnZC9oNlM2d3hQaVVUcHdFc1J1N2Yyem5oK3FXaG9vbXYzUTU3LzZhTjBVV0MxeXJYCkh5YmJsOFNTemdLb2NRSVRnZU5OQ2RlNW1yMjgyVHA2NVJMbHhYZHB2aTk1Z3lFeTlRV0F6ZERBNEVGYUdDVWIvWlZjckE3ZTVDMSsKdlFTN1hUdEdBR1gyUjZZcU5nanlzYW1LTzcvNXRXRWxUSzhxMEFSZ0R5ZGM0WDJWMGRxazRLSGw1eHV5ZElMdnM1OHBTdzJ0SzdEYgpxWnVZeVhRVHpENENXL0VPblUzUlJGN3locVZWVDFaNkF4WmlvWjhOSHZPc3ZqOGJLb0tCeTd6WlByNWZNOS9MVXVXeE1kN2dMQ3lzClI3NDZYdEhoOVpjclM3cktXUGNtNzZQNUhiVllTeVVoMDd6K2NUclFsd3k1dGtJRGc3SDNna2xHU2hHamswenNvd2UreEZVdXk4QmgKSmJpUzI5VFNPUUx3TlM5dUZRWmlvWjhPSGdYT3JULzhPOE5LV2pLNVZrZHRGaWVSNUkyczhMbUp0RW0wTDc0YU1aSWIrOUpYL3pGbAo0eFlYcFpXeVVZbk0rZ0cwbFMwejFIb0VOUTBYR2hpTUIwYUdqWk9ZYWdSR2htdTVtbGVVTHQ0aXFJMDV4SU1IdkNBSm9zZGdkMEdzCkF0aE8xMVBmM1NHWlFxdmhNMG0yN01LMDRwSC8rSldaeGtiWnoyN2s5WGNTek91VWpvWXNxMWdtNDlkbGhsM2ZVS2VmMGRsSkdwM1UKb0JxQmtlRTdCRS9Nb1lXcldRRzc2eTNiekVUMjR6ZDRFVEwwSkhNNm00YkhsWHI0azE5WUNsQnBUU21HdlM5enJLZm56ci8rMnJCUwpaaEhzTG1iUjJ3NWxTWlhJYlV3bXBhNS9oZm81UlN0N3d2dlpDUTNZVnVZQjhNY1U2ZXV3aDU3eWtSbkpmRTZwWW40RGI3U09RQ3hZClNmTk5ZR1I0RThCZWFHRFFKR2h4cUxhVHRBaWozRXFadGZ4N3NhUStGYTU1a1o4YWdQUVlpUTVmVWd0VkRic3hka2VEK1dPS3N3VGkKVHFTWUx0aGplVExxRXFDT1BvYmRyYnQ3YXFqMkwvL29nbWxWMFhKNkdaLzJVQ2NiU1lKOEFYbFNjbFBMcjNWY05BUEFxOERJOEM0QQpoQVlHTFk4cTVaczRaUXN6VHc4M2dhemtDcmNvRUJvQXpBUkdoaGVQTk5LZUp2TUNxSVJwTmZCdnVzakUyMXljYXVSMzZ1MWRPdnBPCnJEd0Fmc01MdThId3A4N2hVcG5NbmRlU1laSlp6YXRZOGhrOXFvdEFkNUdKdmJBMzgrck9tSWJtV3RwYjQzWEpsTVlqT3RGakhSMi8KWlN5M1RpL3JTd3NuM0E0Q0txQitwS3J6MWZ6L01xL3ZDa0VNRUZUWmF5ckVucEdFZWE4WjY0WUo1QmkvRjAxblpvUm1KVEdWbjB6dApwamxXT0h6UmJ0Z0RCK1ZjekZkY1dCbjR2MHdHVjlPaE9mMUlFWk1sbFlCTUVhdGxTbEVNYVR1WU9tZ3ZWYWxkZ1BGYUcxbFNxMUl3CnB3ZEpwYlMyeWZlcjRiVTV2VUZuVWFkM2FOSkxqSkcvcHZROEI3Q1duaHFmbGs0YXNFOHRrT0pBSjAxTVppS3JDaVQyS2Q2WXlFRWgKOW81RUY1L1NqQ2NKNWlLenNKM1F3R0E4MjBKSEZRSDFNNzI4VGwycjU4OUtIWFpVVmdGQVRGTDN0Z2hraEN4OHBNSzEvVXlMeHU4cQp3Ym1wbC9VMDlWWlZndXVGM1laOGtYczN0K21odzZxRXVFRG5zaDRhR056TlM2VTlORENZQ293TWIxT0lGMVZldXFvMHJZbE9vWXptCmY5NkJsZXhxRDNaM3g0Umk0eHp2TFFVbjIyTUNJOFBGak8wdTBkemJHWnRLN05lRTg5KzdHYU0zbmlNVEowbVNSYkp4TXpRd21QVU8KNWxuMmdCSk0rTmRoOStwSW1MREZnTCtlNFUwSnprZTNzUjZMMXMxYU1pUVZwbFpHQWFSeTJVeER0bWFwNnA5TlpLbVBBZlVOMk9keQpWSjBEczVkbXJSYzA1d21DR1NFYjF3REVjZ1V4SnpBVm9CSk8xUkxRQUQyL3pCWEprRllSQ3RjVWF6S3NpdEtLRnVsWWZzZFU4QVgxClBva2N0M2J6QnVZSmVsb04rMWl4RHRoYkh1M1UycElDbVhXYyt2ZVVaanhGalZ5Z21SK3JRZWE3dEpSN2ZjMTdrRERqUld1d2pBM1kKZTluUFlSOGxkald0NEp6UGNSaXRpenV3VzJRZTBFdExpOHdCWEpicHFZZzZWaGx6Uk5NQ0k4T3k2OWdNdTRXN2gyejE1Ymx1YW5MUgpuc0Z1WHAzaFlyNWlDcmhmQ0gzSm1Kbis0S2h1U05EZVd0cjM0bGJLTUovK3d3OHN3NVBhczVMdUdQTmJtWitSUm9FbzdLYlkwaXoxClZOSk5xZXBFV0l5UUEwd1dBRVJoSUdtNFV5a0E4UDl5MUlCeGROS2hESXRKR25rQUlCRU85cWNLWmViaXdSdHB0ZzJ3dDJJakFCWU4KanhVRllEMzh5VjlKQVRVUkdCbE84UGQybVo2TmthWFNjbmc1aTN3L3hzV1paNndvSThzTC9QNzJXNDdGZ01FRmxCSHdTc3JETXV5bQppVDNIek53ZkhIWEJQbTVDNm96U21ORE1YMXVGM1EyeFF0M2FoNEZrK0pmOVptQmsySUJodVdBWmN2eGpQZi8rTXhaUXVyZ3dYdGduCnV4Z25tSEtTTE5vallGUE1XaDVRSXpjQnhHQll5ZEJQLzlMazlZc2xTY1BEeDdDbm1LVTk1aGxmYTU2V3RNdnZwOExCZmpPZnpKUlcKNjNiWUExWnRLdXdCd2Vza01QWmd1NFZsMkowUUtUNWpnWkhoR0lIWnBQbDN3QjQyYU1iSkczcnkrOUlhTTAwQTU4bkc5Vk5LWXlWawo0VFcrUjZleWhuSytyaHdDS0FPbVVyZmNPbXRLNlhtSExwYkRicEc1ZzhOdEF6OXZXRzljcFhpaG41Q2hsOG1DRW45d2RKMG1lV0FVCm1hbkp2LytoMUF3WGxkZVZOcFJOdnI0MGNibFU1aVZSd2hNQS8wdEE1WHpNaE9FMlRXVkpidGhud1YxV3hXNkpmNlUxM0FXN0ljd1AKKytRdzZSMTk2UStPSGgwWENjQU1CL3V0ak1FTUIvc3RmM0MwbkRlazJkaE9uVHl0OGw2cW5GSXRGMkNHcXp3TFlOR0t1emRZUUJFOQpUUVpHaHVOMEl2dXdKK0xhRlVOTlppa3YrSHF6Tk12WE9Hd0tNMCtvMmt0VG1GeTdESUg1S0NmRnB6Qll1dlRreU1wcDlaNnZ3c0grCjZIczFNMDBYeTNrak44bkUyd1NtVXVtWjZ4MGhpbXpjUzBYbUVRNmJVQ2ZKdm0wQUNWaEcwbDE1WUhuYlYyRWwzY0ltWWRJMVBqOGkKSTZSaU5VdGdFekNzRkN6RGpJNWZPcXk5R2tmWFgwZlErbkI0OXNoMXZxWSs0Y0YxU3F3cXVud0FlelRuTVE1YkZ5Zm9HNktNWEpJbgpzZFRETjVGR3JVNnVwb3hJdHlEejNVcDlVRWdwVGNVTHUrdGk1a2hQRGV2TitOLzhhRi9KUkFyQUFUMi9uQzFVRFh0Q2JnM0FtL1IyCkdoS2hsQmJUd2V2djVML2J1U0NaREhycDQzaEtWQXBjU1hMNVZZZ25uY21wazVncEFON0c0WENVTklLV3d6N2I5NndCdG5ZNk1vc3oKUjgvN0FNZEg2NUpXMHBVcS9uZ0hSUTI3QnF5am0zSkROLzliU0lWK05taXFlTEdZTjl0RXZmdENiYTlJZEpEdHNaT1dZdWtlWldVTQpkb1B0REJjNHJtTlRENEEvNTBwMnFicGtyc09sY29LWFI2MTBtUXBQUkl0bUFid3dQT2IyazcvK2l4U096MzJmOXNweWhHTXIyZGVoCnRGRzJWVXJ5Y1AxRmZKYnhLZHZTN1hTQWp3Qk0rSU9qVytKdlBEZzhMNzJWcGlKdGQvbmVmL0ZTdStwNTB4SHEwQVArN0tVL09McEQKdlgwcnZtTzg2SUc5NFNjbnlVcnpoQnpGVyt4UWdicFVPVENSdnppMWZFc3pjNDlmTSttL3pMb1dBdnU0eFRMbDdPcVY1NStEdlMrZApua3VYRXpDZjBzWnUvbTB6bk4zYk45SmtSN0s1UFM2OHhaQVNIdWF6WWhhMU9ENlk3MVJ4dDRvc2F5YXpwSFg3RVlCeGYzQjBsYVp1CjhmZGFZQi9GK3lrdHFVcmw5azZXOUZLOGxoanNZWWdRQ3lsUk1YRUI4MzhvcHRPd0Iwa2x6bk5xcFQzS0dpb1ZVK1g0M1FnZGxJZnkKYzAzRmpkSVBWWWo5cGhUc2dhM25LaUtaWnV3YlR3K05RZ3l1cjZyNDhoWlh2MHg1ZEtjcTVXNENWa1U5K2xRRjUxN1k1N3czS2VCZApEakpSUExta3NMUDA0QTloOXhqSndGYmlyVUlIYmI1V3habzlPSDU4UkM3dDJHZGxRcFFYL0pvYXE4Y0RDOUhaSVdNeVV1U2VUbVBqCjNtbHBwWFk0MjVDaHFNTWN1MTNsNU4wMHdSTGtmNUEwM1ZHVmNRR2JWQkxnY1JoQXlkNTIxWjdSNzZuaEw1Z1J5WEVUWnl2QitZT2oKWHJLeEUvWVFxZWlwcEdlRjZJc3N4Q05PYzlacHF4eVQrd3pBUmpqWW45SEhPSnkyNGdlcU52bU1tdEd0c293V3lzSkZQTURad3ZFRApuRGQ0ancvcFAvUW50cHpwdUluM2dzQ0F1WnFtMTRQRERvNE9PaWhwcFM2OVFJQktuTGhNRTVhOW93bDY2NlZ3c0Qrcmo3N0pSSXRNCnhkRFhwSDg3NDc3UFdKbHBWUEhwZVQzMFh0SlVPYlRsTWV3dTRIbWErajV5K0dTV005KzBQemhhekZCR3hrYjhLc1dTeGxqUE9kUkYKYVdCZG9DNU93aDZVV2ozckZrVzJ6TVFKV3doUzhYbE9qM2Vkc2VsdE9xMHFmUGlEbjAxVm8xd2xjTUxHS2RnRC9sSGthY29rNXh2MQpCMGNycUovU3dkRUQreEMrQmpnM1cvUytlSFdiV3lQaXBjT0tqWXZoWUgvZVQ0L0poem5LUVh6ckoyUlMwaFJiQnVjL0UwajN4RytsClZhWW1DZW82OWQrUlQ2eks2NDFSVDJ0aGQ4VDVhZmJpOWF2aFRNK1J6R25LY1JNUkZTdU84Zi9iNFdCL3drbHp5TGVqa1BNenhzbUUKTVhwK1hlM1JKM0hsNndQcG9qVHBHZGlIMDg4VFdEbHVJdW0wdGppbVpkeWZxYUIyK21FM0hMVEMvb2lIc2h5cVAwbllEYXhTMVFuRAozbFo0bmNtTzRvVUFrNERLdG9VMGNsMGpzUEtSRDdMaDVjSFpqdUtSWTc0bG12Z0c5dmthRzR3MDRybjJEcDByTUU4QXRwR0EzaUNZCjdhcW9VWk9CbmtvRHF4eVdONjJBbER6NjIvbnhzaWNBS2tYZ0doWk11Z2pxVFlaVTlYaTdLMDUwVVk1SG02QW1paTdLNGRON1RqdVkKY3dXbUFsWGF0L1hIRzl4Z2ZDcGUzNnVjeXlaVFdabVNHR084dUFMZzRFT3lVVC8rRDJGeEx2ekhFVTc0QUFBQUFFbEZUa1N1UW1DQwoKIgogICAgICAgaWQ9ImltYWdlMTAiCiAgICAgICB4PSIwLjMzMTU0MTcyIgogICAgICAgeT0iMC4yMzkxNzExOCIgLz4KICA8L2c+Cjwvc3ZnPgo="
LABEL oc.keyword="NGFF"
LABEL oc.cat="development"
LABEL oc.template="abcdesktopio/oc.template.gtk"
LABEL oc.name="ngff"
LABEL oc.launch="com.glencoesoftware.convert.App.com.glencoesoftware.convert.App"
LABEL oc.displayname="NGFF Converter v2.0.2"
LABEL oc.path="/opt/NGFF-Converter/build/distributions/NGFF-Converter-2.0.2/bin/NGFF-Converter"
LABEL oc.type=app
LABEL oc.rules="{\"homedir\":{\"default\":true}}"
LABEL oc.acl="{\"permit\":[\"all\"]}"
LABEL oc.showinview=dock
RUN for d in /usr/share/icons /usr/share/pixmaps ; do echo "testing link in $d"; if [ -d $d ] && [ -x /composer/safelinks.sh ] ; then echo "fixing link in $d"; cd $d ; /composer/safelinks.sh ; fi; done


RUN mkdir -p /etc/localaccount
RUN for f in passwd shadow group gshadow ; do if [ -f /etc/$f ] ; then  cp /etc/$f /etc/localaccount; rm -f /etc/$f; ln -s /etc/localaccount/$f /etc/$f; fi; done

ENV APPNAME "ngff"
ENV APPBIN "/opt/NGFF-Converter/build/distributions/NGFF-Converter-2.0.2/bin/NGFF-Converter"
ENV APP "/opt/NGFF-Converter/build/distributions/NGFF-Converter-2.0.2/bin/NGFF-Converter"
ENV TMPDIR=$HOME/tmp

CMD ["sh", "-c","mkdir -p ~/tmp && /composer/appli-docker-entrypoint.sh "]
